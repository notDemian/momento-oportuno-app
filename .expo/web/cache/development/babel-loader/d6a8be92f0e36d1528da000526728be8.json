{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport * as React from 'react';\nimport Linking from \"react-native-web/dist/exports/Linking\";\nimport View from \"react-native-web/dist/exports/View\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport dayjs from 'dayjs';\nimport { Button, Dialog, Divider, Text } from \"../../elements\";\nimport { getStoreName, getStoreURL } from \"../../../utils/store-info\";\nimport { AppReviewConfig } from \"../../../constants\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar REMIND_LATER_DATE = AppReviewConfig.REMIND_LATER_DATE,\n  CANCELED = AppReviewConfig.CANCELED,\n  USES_UNTIL_SHOW = AppReviewConfig.USES_UNTIL_SHOW;\nvar AppReviewModal = function AppReviewModal(_ref) {\n  var _ref$storeURL = _ref.storeURL,\n    storeURL = _ref$storeURL === void 0 ? getStoreURL() : _ref$storeURL,\n    _ref$daysBeforeRemind = _ref.daysBeforeReminding,\n    daysBeforeReminding = _ref$daysBeforeRemind === void 0 ? 1 : _ref$daysBeforeRemind,\n    _ref$usesUntilShow = _ref.usesUntilShow,\n    usesUntilShow = _ref$usesUntilShow === void 0 ? 0 : _ref$usesUntilShow,\n    _ref$rateButtonText = _ref.rateButtonText,\n    rateButtonText = _ref$rateButtonText === void 0 ? 'Rate Food Star' : _ref$rateButtonText,\n    _ref$remindLaterButto = _ref.remindLaterButtonText,\n    remindLaterButtonText = _ref$remindLaterButto === void 0 ? 'Remind me later' : _ref$remindLaterButto,\n    _ref$cancelButtonText = _ref.cancelButtonText,\n    cancelButtonText = _ref$cancelButtonText === void 0 ? 'No, thanks' : _ref$cancelButtonText;\n  var _React$useState = React.useState(false),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    isShowAppReview = _React$useState2[0],\n    setIsShowAppReview = _React$useState2[1];\n  React.useEffect(function () {\n    var handleShowAppReviewModal = function handleShowAppReviewModal() {\n      var appReviewCanceled, appReviewRemindLaterDate, usesUntilShowAppReview;\n      return _regeneratorRuntime.async(function handleShowAppReviewModal$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem(CANCELED));\n            case 3:\n              appReviewCanceled = _context.sent;\n              _context.next = 6;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem(REMIND_LATER_DATE));\n            case 6:\n              _context.t0 = _context.sent;\n              if (_context.t0) {\n                _context.next = 9;\n                break;\n              }\n              _context.t0 = '';\n            case 9:\n              appReviewRemindLaterDate = _context.t0;\n              _context.next = 12;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem(USES_UNTIL_SHOW));\n            case 12:\n              _context.t1 = _context.sent;\n              if (_context.t1) {\n                _context.next = 15;\n                break;\n              }\n              _context.t1 = '';\n            case 15:\n              usesUntilShowAppReview = _context.t1;\n              if (!(appReviewCanceled === '1')) {\n                _context.next = 18;\n                break;\n              }\n              return _context.abrupt(\"return\");\n            case 18:\n              if (!(parseInt(usesUntilShowAppReview, 10) < usesUntilShow)) {\n                _context.next = 20;\n                break;\n              }\n              return _context.abrupt(\"return\");\n            case 20:\n              if (!dayjs().isBefore(appReviewRemindLaterDate)) {\n                _context.next = 22;\n                break;\n              }\n              return _context.abrupt(\"return\");\n            case 22:\n              setIsShowAppReview(true);\n              _context.next = 28;\n              break;\n            case 25:\n              _context.prev = 25;\n              _context.t2 = _context[\"catch\"](0);\n              console.log('Failed to fetch the data from storage');\n            case 28:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, [[0, 25]], Promise);\n    };\n    handleShowAppReviewModal();\n  }, [usesUntilShow]);\n  var _onCancelButtonPress = function _onCancelButtonPress() {\n    AsyncStorage.setItem(CANCELED, '1');\n    setIsShowAppReview(false);\n  };\n  var _onRemindLaterButtonPress = function _onRemindLaterButtonPress() {\n    AsyncStorage.setItem(REMIND_LATER_DATE, dayjs().add(daysBeforeReminding, 'day').toString());\n    setIsShowAppReview(false);\n  };\n  var _onRateButtonPress = function _onRateButtonPress() {\n    AsyncStorage.setItem(CANCELED, '1');\n    setIsShowAppReview(false);\n    Linking.openURL(storeURL);\n  };\n  var _renderFooter = function _renderFooter() {\n    return _jsxs(View, {\n      children: [_jsx(Button, {\n        isTransparent: true,\n        onPress: _onRateButtonPress,\n        children: _jsx(Text, {\n          isPrimary: true,\n          children: rateButtonText\n        })\n      }), _jsx(Divider, {}), _jsx(Button, {\n        isTransparent: true,\n        onPress: _onRemindLaterButtonPress,\n        children: _jsx(Text, {\n          children: remindLaterButtonText\n        })\n      }), _jsx(Divider, {}), _jsx(Button, {\n        isTransparent: true,\n        onPress: _onCancelButtonPress,\n        children: _jsx(Text, {\n          children: cancelButtonText\n        })\n      })]\n    });\n  };\n  return _jsx(Dialog, {\n    title: 'Enjoying Food Star app?',\n    isTitleCentered: true,\n    isVisible: isShowAppReview,\n    footer: _renderFooter(),\n    children: _jsxs(Text, {\n      isCenter: true,\n      children: [\"If you enjoy Food Star, please take a moment to rate it in\", ' ', getStoreName(), \". Your support is deeply appreciated!\"]\n    })\n  });\n};\nexport default AppReviewModal;","map":{"version":3,"names":["React","AsyncStorage","dayjs","Button","Dialog","Divider","Text","getStoreName","getStoreURL","AppReviewConfig","REMIND_LATER_DATE","CANCELED","USES_UNTIL_SHOW","AppReviewModal","storeURL","daysBeforeReminding","usesUntilShow","rateButtonText","remindLaterButtonText","cancelButtonText","useState","isShowAppReview","setIsShowAppReview","useEffect","handleShowAppReviewModal","getItem","appReviewCanceled","appReviewRemindLaterDate","usesUntilShowAppReview","parseInt","isBefore","console","log","_onCancelButtonPress","setItem","_onRemindLaterButtonPress","add","toString","_onRateButtonPress","Linking","openURL","_renderFooter"],"sources":["/Users/vunguyen/Documents/work/jcstudio/food-star-expo-app-template/src/components/common/AppReviewModal/AppReviewModal.tsx"],"sourcesContent":["import * as React from 'react';\nimport {Linking, View} from 'react-native';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport dayjs from 'dayjs';\nimport {Button, Dialog, Divider, Text} from '@src/components/elements';\nimport {getStoreName, getStoreURL} from '@src/utils/store-info';\nimport {AppReviewConfig} from '@src/constants';\n\nconst {REMIND_LATER_DATE, CANCELED, USES_UNTIL_SHOW} = AppReviewConfig;\n\ntype AppReviewModalProps = {\n  storeURL?: string;\n  daysBeforeReminding?: number;\n  usesUntilShow?: number;\n  rateButtonText?: string;\n  remindLaterButtonText?: string;\n  cancelButtonText?: string;\n};\n\nconst AppReviewModal: React.FC<AppReviewModalProps> = ({\n  storeURL = getStoreURL(),\n  daysBeforeReminding = 1,\n  usesUntilShow = 0,\n  rateButtonText = 'Rate Food Star',\n  remindLaterButtonText = 'Remind me later',\n  cancelButtonText = 'No, thanks',\n}) => {\n  const [isShowAppReview, setIsShowAppReview] = React.useState(false);\n\n  React.useEffect(() => {\n    const handleShowAppReviewModal = async () => {\n      try {\n        const appReviewCanceled = await AsyncStorage.getItem(CANCELED);\n        const appReviewRemindLaterDate =\n          (await AsyncStorage.getItem(REMIND_LATER_DATE)) || '';\n        const usesUntilShowAppReview =\n          (await AsyncStorage.getItem(USES_UNTIL_SHOW)) || '';\n\n        if (appReviewCanceled === '1') {\n          return;\n        }\n\n        if (parseInt(usesUntilShowAppReview, 10) < usesUntilShow) {\n          return;\n        }\n\n        if (dayjs().isBefore(appReviewRemindLaterDate)) {\n          return;\n        }\n\n        setIsShowAppReview(true);\n      } catch (e) {\n        console.log('Failed to fetch the data from storage');\n      }\n    };\n\n    handleShowAppReviewModal();\n  }, [usesUntilShow]);\n\n  const _onCancelButtonPress = () => {\n    AsyncStorage.setItem(CANCELED, '1');\n    setIsShowAppReview(false);\n  };\n\n  const _onRemindLaterButtonPress = () => {\n    AsyncStorage.setItem(\n      REMIND_LATER_DATE,\n      dayjs().add(daysBeforeReminding, 'day').toString(),\n    );\n    setIsShowAppReview(false);\n  };\n\n  const _onRateButtonPress = () => {\n    AsyncStorage.setItem(CANCELED, '1');\n    setIsShowAppReview(false);\n    Linking.openURL(storeURL);\n  };\n\n  const _renderFooter = () => {\n    return (\n      <View>\n        <Button isTransparent onPress={_onRateButtonPress}>\n          <Text isPrimary>{rateButtonText}</Text>\n        </Button>\n        <Divider />\n        <Button isTransparent onPress={_onRemindLaterButtonPress}>\n          <Text>{remindLaterButtonText}</Text>\n        </Button>\n        <Divider />\n        <Button isTransparent onPress={_onCancelButtonPress}>\n          <Text>{cancelButtonText}</Text>\n        </Button>\n      </View>\n    );\n  };\n\n  return (\n    <Dialog\n      title={'Enjoying Food Star app?'}\n      isTitleCentered\n      isVisible={isShowAppReview}\n      footer={_renderFooter()}>\n      <Text isCenter>\n        If you enjoy Food Star, please take a moment to rate it in{' '}\n        {getStoreName()}. Your support is deeply appreciated!\n      </Text>\n    </Dialog>\n  );\n};\n\nexport default AppReviewModal;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}